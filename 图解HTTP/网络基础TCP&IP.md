[TOC]

# 网络基础TCP/IP

## 基本概念

- HTML：HyperText Markup Language，超文本标记语音
- IP地址：指节点被分配到的地址，IP地址可更改。
- MAC地址：网卡所属的固定地址，MAC地址基本不会更改。

### URI和URL关系

- URI（Uniform Resource Identifier）：统一资源标识符，用字符串标识某一互联网资源。
- URL（Uniform Resource Locator）：统一资源定位符，表示资源的地点，URL是URI的子集。

**URI格式：**

![在这里插入图片描述](https://img-blog.csdnimg.cn/743337edeb0c4fc79c18d35d5577d019.png)

### HTTP和TCP/IP关系

- HTTP：HyperText Transfer Protocol，超文本传输协议，用于客户端和服务器之间的通信协议。
- TCP/IP：TCP/IP协议其实是一系列与互联网相关联的协议集合起来的总称。

通常使用的网络（包含互联网）是在TCP/IP协议族的基础上运作的。HTTP协议同样也是构建在TCP/IP协议之上的，是TCP/IP协议的一个子集。



## TCP/IP

### OSI分层和TCP/IP分层

![在这里插入图片描述](https://img-blog.csdnimg.cn/d677627b6eec4a798c76b53a145bd4ed.png)

**应用层：**

- 应用层可以通过系统调用与传输层进行通信。定义数据的传输方式。
- TCP/IP协议族内预存了各类通用的应用服务。如FTP、DNS、HTTP等。


**传输层：**

- 传输层通过系统调用向应用层提供处于网络连接中的两台计算机之间的数据传输功能。
- 传输层有两个性质不同的协议：TCP、UDP。

**网络层：**

- 网络层用来处理在网络上流动的数据包。
- 该层规定了通过怎样的传输路线到达对方计算机，并把数据包传送给对方。
- 网络传输的最小数据单位是数据包。

**数据链路层：**

- 链路层用来处理连接网络的硬件部分。
- 包括：控制操作系统、硬件的设备驱动、网卡等物理设备。



### HTTP数据传输过程

![在这里插入图片描述](https://img-blog.csdnimg.cn/6a27b9a5c39c44ffa8cac241c58dec84.png)

利用TCP/IP协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端则往应用往上走。

以HTTP请求举例，首先作为发送端的客户端在应用层（HTTP协议）发出一个HTTP请求；接着为了方便传输，在传输层（TCP协议）把从应用层接收到的数据进行分割，并在各个报文上打上标记序号及端口号后转发给网络层；在网络层（IP协议），添加作为通信目的地的MAC地址后转发给链路层。

**数据包的封装过程：**

![在这里插入图片描述](https://img-blog.csdnimg.cn/9cf33feddc7446eb8645e7c58f187be9.png)



## 可靠的TCP协议

### 三次握手

![在这里插入图片描述](https://img-blog.csdnimg.cn/b9e30d37a687452b8a6df77980ccf129.png)

使用TCP协议进行通信的双方必须先建立连接，然后才能开始传输数据。为了确保连接双方可靠性，在双方建立连接时，TCP协议采用三次握手策略。

握手过程中使用了TCP的标志：SYN（synchronize）、ACK（acknowledgement）。

**第一次握手：**客户端发送带有SYN标志的连接请求数据包，然后进入SYN_SEND状态，等待服务端的确认。

**第二次握手：**服务端接收到客户端的SYN数据包后，需要发送SYN+ACK标志的数据包给客户端，服务端进入SYN_RECV状态。

**第三次握手：**客户端接收到服务端的SYN+ACK标志的数据包后，会向服务端发送ACK数据包，这个报文段发送完毕后，客户端和服务端都进入ESTABLISHED状态，完成TCP三次握手。

如果在握手过程中某个阶段中断了，TCP协议会再次以相同的顺序发送相同的数据包。



### 四次挥手

当客户端和服务器通过三次握手建立了TCP连接之后，当数据传送完毕，就要断开TCP连接的。

![在这里插入图片描述](https://img-blog.csdnimg.cn/27c30370de834c0e977f80dc6553b317.png)

1. 客户端打算关闭连接，会发送一个FIN标志的数据包到服务端。
2. 服务端收到报文后，就向客户端发送ACK标志的数据包，服务端进入关闭等待状态。
3. 等待服务端的处理完数据后，向客户端发送FIN标志的数据包。
4. 客户端收到报文后，回传给ACK标志的数据包，服务端进入关闭状态，客户端经过一段时间后自动进入关闭状态。



## DNS服务

DNS（Domain Name System）服务是和HTTP协议一样位于应用层的协议。它提供域名到IP地址之间的解析服务。

计算机既可以被赋予IP地址，也可以被主机名和域名。如www.hackr.jp。

DNS协议提供通过域名查找IP地址，或逆向从IP地址反查域名的服务。

![在这里插入图片描述](https://img-blog.csdnimg.cn/6d16304f56b64011b7988e40f98f110a.png)



## HTTP请求流程

![在这里插入图片描述](https://img-blog.csdnimg.cn/994344e671924700b013a05d910c27c5.png)



